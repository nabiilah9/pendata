
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>K-Means Clustering &#8212; Penambangan Data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'clustering';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Decision Tree" href="decisiontree.html" />
    <link rel="prev" title="UTS" href="uts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/2.png" class="logo__image only-light" alt="Penambangan Data - Home"/>
    <img src="_static/2.png" class="logo__image only-dark pst-js-only" alt="Penambangan Data - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Penambangan Data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data_understanding.html">Memahami Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="naive_bayes.html">Metode Klasifikasi Naive Bayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="uts.html">UTS</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">K-Means Clustering</a></li>

<li class="toctree-l1"><a class="reference internal" href="decisiontree.html">Decision Tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="binning%28diskritisasi%29.html">Binning (Diskritisasi) menggunakan K-Means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="heart_disease.html">Implementasi Model Klasifikasi untuk Prediksi Tingkat Keparahan Penyakit Jantung Berdasarkan Data Medis</a></li>
<li class="toctree-l1"><a class="reference internal" href="uas.html">Prediksi Diagnosis Kanker Payudara</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fclustering.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/clustering.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>K-Means Clustering</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">K-Means Clustering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah-algoritma-k-means">Langkah-langkah algoritma K-Means :</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi-hasil-k-means">Evaluasi Hasil K-Means</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#komputasi-k-means-data-iris">Komputasi K-Means Data IRIS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klaster">2 Klaster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3 Klaster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4 Klaster</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metode-elbow">Metode Elbow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzy-c-mean">Fuzzy C-mean</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konsep-fuzzy-c-mean">Konsep Fuzzy C-mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah">Langkah-langkah</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#komputasi-fuzzy-c-mean">Komputasi Fuzzy C-mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-data-iris-3-klaster">Implementasi data iris 3 klaster</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="k-means-clustering">
<h1>K-Means Clustering<a class="headerlink" href="#k-means-clustering" title="Link to this heading">#</a></h1>
<p>K-Means clustering merupakan salah satu metode dalam unsupervised learning yang digunakan untuk mengelompokkan data ke dalam beberapa kelompok (cluster) berdasarkan kesamaan karakteristik atau fitur. Tujuan utamanya adalah untuk membagi data ke dalam K kelompok yang saling terpisah, dimana dalam kelompok data bersifat homogen dan antar kelompok data bersifat heterogen.</p>
<section id="langkah-langkah-algoritma-k-means">
<h2>Langkah-langkah algoritma K-Means :<a class="headerlink" href="#langkah-langkah-algoritma-k-means" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Menentukan jumlah kluster sebanyak <span class="math notranslate nohighlight">\(K\)</span></p></li>
</ol>
<ul class="simple">
<li><p>Artinya menentukan berapa banyak kelompok/kluster yang ingin dibuat dari data. Misalnya <span class="math notranslate nohighlight">\(K\)</span> = 3 maka membagi data menjadi 3 kluster.</p></li>
<li><p>Pemilihan nilai <span class="math notranslate nohighlight">\(K\)</span> dapat menggunakan metode seperti Elbow Method untuk membantu menentukan <span class="math notranslate nohighlight">\(K\)</span> yang optimal.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Memilih K centroid awal secara acak</p></li>
</ol>
<ul class="simple">
<li><p>Artinya menentukan titik awal (centroid) sebagai pusat dari masing-masing kluster.</p></li>
<li><p>Centroid bisa dipilih secara acak dari data yang ada atau menggunakan teknik seperti K-Means++ dimana dijalankan secara otomatis pada scikit-learn untuk hasil centroid yang lebih baik.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Menghitung jarak setiap data ke tiap centroid</p></li>
</ol>
<ul class="simple">
<li><p>Artinya menentukan seberapa dekat setiap data ke setiap centroid.</p></li>
<li><p>Umumnya menggunakan Euclidian distance.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Mengelompokkan data berdasarkan centroid terdekat</p></li>
</ol>
<ul class="simple">
<li><p>Artinya mengklasifikasikan setiap data ke dalam salah satu dari <span class="math notranslate nohighlight">\(K\)</span> kluster.</p></li>
<li><p>Setiap data ditempatkan ke kluster yang pusatnya (centroid-nya) paling dekat dengannya. Jadi, tiap data hanya masuk ke satu kluster.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Menghitung rata-rata dari anggota kluster, untuk menemukan centroid baru</p></li>
</ol>
<ul class="simple">
<li><p>Menentukan pusat kluster baru berdasarkan data yang saat ini berada dalam kluster tersebut.</p></li>
<li><p>Centroid baru adalah rata-rata dari semua data di dalam suatu kluster.</p></li>
</ul>
<ol class="arabic simple" start="6">
<li><p>Mengulang langkah nomor 3-5 sampai data pada setiap kluster tidak berubah signifikan.</p></li>
</ol>
<ul class="simple">
<li><p>Iterasi dilakukan sampai tidak ada lagi data yang berpindah kluster, atau perubahan posisi centroid sangat kecil.</p></li>
</ul>
</section>
<section id="evaluasi-hasil-k-means">
<h2>Evaluasi Hasil K-Means<a class="headerlink" href="#evaluasi-hasil-k-means" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Inertia (Sum Square Error/SSE)<br />
Inertia mengukur sejauh mana titik data dalam suatu cluster tersebar dari pusat cluster tersebut. Semakin kecil nilai inertia, klaster semakin baik.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[Inertia= \sum_{i=1}^{n} \left\| x_i - \mu_{c_i} \right\|^2\]</div>
<p><strong>Keterangan</strong> :<br />
<span class="math notranslate nohighlight">\(x_i\)</span> : Titik data ke-<span class="math notranslate nohighlight">\(i\)</span><br />
<span class="math notranslate nohighlight">\(\mu_{c_i}\)</span> : Centroid dari cluster tempat <span class="math notranslate nohighlight">\(x_i\)</span> berada</p>
<ul class="simple">
<li><p>Nilai inertia (sangat kecil/mendekati 0) : Klaster sangat kompak dan semua titik dekat dengan centroidnya (<strong>sangat baik</strong>).</p></li>
<li><p>Nilai inertia (kecil-sedang) : Klaster cukup baik dan dapat diterima dalam banyak kasus.</p></li>
<li><p>Nilai inertia (besar) : Klaster tidak rapat,  data menyebar jauh dari centroid â†’ bisa jadi jumlah klaster (k) kurang tepat atau K-Means tidak cocok digunakan.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Silhouette Method : Sebuah metode yang mengukur tingkat kemiripan suatu point dengan clusternya dibandingkan dengan kluster lain.</p></li>
</ol>
<ul class="simple">
<li><p>untuk setiap titik <span class="math notranslate nohighlight">\(i\)</span>, silhouette (<span class="math notranslate nohighlight">\(i\)</span>) dihitung sebagai :</p></li>
</ul>
<div class="math notranslate nohighlight">
\[s(i) = \frac{b(i) - a(i)}{\max\{a(i), b(i)\}}\]</div>
<p><strong>Keterangan</strong> :<br />
<span class="math notranslate nohighlight">\(a(i)\)</span> : rata-rata jarak titik <span class="math notranslate nohighlight">\(i\)</span> ke semua titik lain dalam klaster yang sama.<br />
<span class="math notranslate nohighlight">\(b(i)\)</span> : rata-rata jarak titik <span class="math notranslate nohighlight">\(i\)</span> ke semua titik dalam klaster terdekat (tetangga).</p>
<ul class="simple">
<li><p>Nilai silhouette mendekati angka 1 artinya suatu data berada pada cluster yang benar dengan jarak jauh dari cluster lain.</p></li>
<li><p>Nilai silhouette negatif artinya data tersebut lebih baik berada di kluster lain daripada kluster saat ini.</p></li>
<li><p>Nilai silhouette = 0, artinya data tersebut di perbatasan antara dua cluster.</p></li>
</ul>
</section>
<section id="komputasi-k-means-data-iris">
<h2>Komputasi K-Means Data IRIS<a class="headerlink" href="#komputasi-k-means-data-iris" title="Link to this heading">#</a></h2>
<section id="klaster">
<h3>2 Klaster<a class="headerlink" href="#klaster" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Baca data fitur dan label</span>
<span class="n">df_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;data_iris.xlsx&quot;</span><span class="p">)</span>
<span class="n">df_class</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;class.xlsx&quot;</span><span class="p">)</span>  <span class="c1"># kolom &#39;class&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_class</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>

<span class="c1"># Ambil fitur untuk clustering</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">]]</span>

<span class="c1"># Normalisasi fitur(MinMax)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaled_features</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># KMeans clustering</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah iterasi sampai konvergen: </span><span class="si">{</span><span class="n">kmeans</span><span class="o">.</span><span class="n">n_iter_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inertia (SSE): </span><span class="si">{</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sil_score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{</span><span class="n">sil_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Mapping cluster ke class mayoritas</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>

<span class="c1"># Evaluasi</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Akurasi keseluruhan clustering terhadap label asli: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.4%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Distribusi cluster per kelas (untuk insight)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">],</span> <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">],</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribusi cluster per kelas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

<span class="c1"># Simpan hasil ke Excel</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;hasil2.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Kalau ingin tampil semua baris (hati-hati jika data sangat banyak)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_class&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah iterasi sampai konvergen: 4
Inertia (SSE): 12.1437
Silhouette Score: 0.6295

Akurasi keseluruhan clustering terhadap label asli: 66.6667%

Distribusi cluster per kelas:
Cluster           0   1
Class                  
Iris-setosa       0  50
Iris-versicolor  50   0
Iris-virginica   50   0
               class  cluster  predicted_class
0        Iris-setosa        1      Iris-setosa
1        Iris-setosa        1      Iris-setosa
2        Iris-setosa        1      Iris-setosa
3        Iris-setosa        1      Iris-setosa
4        Iris-setosa        1      Iris-setosa
5        Iris-setosa        1      Iris-setosa
6        Iris-setosa        1      Iris-setosa
7        Iris-setosa        1      Iris-setosa
8        Iris-setosa        1      Iris-setosa
9        Iris-setosa        1      Iris-setosa
10       Iris-setosa        1      Iris-setosa
11       Iris-setosa        1      Iris-setosa
12       Iris-setosa        1      Iris-setosa
13       Iris-setosa        1      Iris-setosa
14       Iris-setosa        1      Iris-setosa
15       Iris-setosa        1      Iris-setosa
16       Iris-setosa        1      Iris-setosa
17       Iris-setosa        1      Iris-setosa
18       Iris-setosa        1      Iris-setosa
19       Iris-setosa        1      Iris-setosa
20       Iris-setosa        1      Iris-setosa
21       Iris-setosa        1      Iris-setosa
22       Iris-setosa        1      Iris-setosa
23       Iris-setosa        1      Iris-setosa
24       Iris-setosa        1      Iris-setosa
25       Iris-setosa        1      Iris-setosa
26       Iris-setosa        1      Iris-setosa
27       Iris-setosa        1      Iris-setosa
28       Iris-setosa        1      Iris-setosa
29       Iris-setosa        1      Iris-setosa
30       Iris-setosa        1      Iris-setosa
31       Iris-setosa        1      Iris-setosa
32       Iris-setosa        1      Iris-setosa
33       Iris-setosa        1      Iris-setosa
34       Iris-setosa        1      Iris-setosa
35       Iris-setosa        1      Iris-setosa
36       Iris-setosa        1      Iris-setosa
37       Iris-setosa        1      Iris-setosa
38       Iris-setosa        1      Iris-setosa
39       Iris-setosa        1      Iris-setosa
40       Iris-setosa        1      Iris-setosa
41       Iris-setosa        1      Iris-setosa
42       Iris-setosa        1      Iris-setosa
43       Iris-setosa        1      Iris-setosa
44       Iris-setosa        1      Iris-setosa
45       Iris-setosa        1      Iris-setosa
46       Iris-setosa        1      Iris-setosa
47       Iris-setosa        1      Iris-setosa
48       Iris-setosa        1      Iris-setosa
49       Iris-setosa        1      Iris-setosa
50   Iris-versicolor        0  Iris-versicolor
51   Iris-versicolor        0  Iris-versicolor
52   Iris-versicolor        0  Iris-versicolor
53   Iris-versicolor        0  Iris-versicolor
54   Iris-versicolor        0  Iris-versicolor
55   Iris-versicolor        0  Iris-versicolor
56   Iris-versicolor        0  Iris-versicolor
57   Iris-versicolor        0  Iris-versicolor
58   Iris-versicolor        0  Iris-versicolor
59   Iris-versicolor        0  Iris-versicolor
60   Iris-versicolor        0  Iris-versicolor
61   Iris-versicolor        0  Iris-versicolor
62   Iris-versicolor        0  Iris-versicolor
63   Iris-versicolor        0  Iris-versicolor
64   Iris-versicolor        0  Iris-versicolor
65   Iris-versicolor        0  Iris-versicolor
66   Iris-versicolor        0  Iris-versicolor
67   Iris-versicolor        0  Iris-versicolor
68   Iris-versicolor        0  Iris-versicolor
69   Iris-versicolor        0  Iris-versicolor
70   Iris-versicolor        0  Iris-versicolor
71   Iris-versicolor        0  Iris-versicolor
72   Iris-versicolor        0  Iris-versicolor
73   Iris-versicolor        0  Iris-versicolor
74   Iris-versicolor        0  Iris-versicolor
75   Iris-versicolor        0  Iris-versicolor
76   Iris-versicolor        0  Iris-versicolor
77   Iris-versicolor        0  Iris-versicolor
78   Iris-versicolor        0  Iris-versicolor
79   Iris-versicolor        0  Iris-versicolor
80   Iris-versicolor        0  Iris-versicolor
81   Iris-versicolor        0  Iris-versicolor
82   Iris-versicolor        0  Iris-versicolor
83   Iris-versicolor        0  Iris-versicolor
84   Iris-versicolor        0  Iris-versicolor
85   Iris-versicolor        0  Iris-versicolor
86   Iris-versicolor        0  Iris-versicolor
87   Iris-versicolor        0  Iris-versicolor
88   Iris-versicolor        0  Iris-versicolor
89   Iris-versicolor        0  Iris-versicolor
90   Iris-versicolor        0  Iris-versicolor
91   Iris-versicolor        0  Iris-versicolor
92   Iris-versicolor        0  Iris-versicolor
93   Iris-versicolor        0  Iris-versicolor
94   Iris-versicolor        0  Iris-versicolor
95   Iris-versicolor        0  Iris-versicolor
96   Iris-versicolor        0  Iris-versicolor
97   Iris-versicolor        0  Iris-versicolor
98   Iris-versicolor        0  Iris-versicolor
99   Iris-versicolor        0  Iris-versicolor
100   Iris-virginica        0  Iris-versicolor
101   Iris-virginica        0  Iris-versicolor
102   Iris-virginica        0  Iris-versicolor
103   Iris-virginica        0  Iris-versicolor
104   Iris-virginica        0  Iris-versicolor
105   Iris-virginica        0  Iris-versicolor
106   Iris-virginica        0  Iris-versicolor
107   Iris-virginica        0  Iris-versicolor
108   Iris-virginica        0  Iris-versicolor
109   Iris-virginica        0  Iris-versicolor
110   Iris-virginica        0  Iris-versicolor
111   Iris-virginica        0  Iris-versicolor
112   Iris-virginica        0  Iris-versicolor
113   Iris-virginica        0  Iris-versicolor
114   Iris-virginica        0  Iris-versicolor
115   Iris-virginica        0  Iris-versicolor
116   Iris-virginica        0  Iris-versicolor
117   Iris-virginica        0  Iris-versicolor
118   Iris-virginica        0  Iris-versicolor
119   Iris-virginica        0  Iris-versicolor
120   Iris-virginica        0  Iris-versicolor
121   Iris-virginica        0  Iris-versicolor
122   Iris-virginica        0  Iris-versicolor
123   Iris-virginica        0  Iris-versicolor
124   Iris-virginica        0  Iris-versicolor
125   Iris-virginica        0  Iris-versicolor
126   Iris-virginica        0  Iris-versicolor
127   Iris-virginica        0  Iris-versicolor
128   Iris-virginica        0  Iris-versicolor
129   Iris-virginica        0  Iris-versicolor
130   Iris-virginica        0  Iris-versicolor
131   Iris-virginica        0  Iris-versicolor
132   Iris-virginica        0  Iris-versicolor
133   Iris-virginica        0  Iris-versicolor
134   Iris-virginica        0  Iris-versicolor
135   Iris-virginica        0  Iris-versicolor
136   Iris-virginica        0  Iris-versicolor
137   Iris-virginica        0  Iris-versicolor
138   Iris-virginica        0  Iris-versicolor
139   Iris-virginica        0  Iris-versicolor
140   Iris-virginica        0  Iris-versicolor
141   Iris-virginica        0  Iris-versicolor
142   Iris-virginica        0  Iris-versicolor
143   Iris-virginica        0  Iris-versicolor
144   Iris-virginica        0  Iris-versicolor
145   Iris-virginica        0  Iris-versicolor
146   Iris-virginica        0  Iris-versicolor
147   Iris-virginica        0  Iris-versicolor
148   Iris-virginica        0  Iris-versicolor
149   Iris-virginica        0  Iris-versicolor
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>3 Klaster<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Baca data fitur dan label</span>
<span class="n">df_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;data_iris.xlsx&quot;</span><span class="p">)</span>
<span class="n">df_class</span>    <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;class.xlsx&quot;</span><span class="p">)</span>  <span class="c1"># kolom &#39;class&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_class</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>

<span class="c1"># Ambil fitur untuk clustering</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">]]</span>

<span class="c1"># Normalisasi fitur (MinMax)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaled_features</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># KMeans clustering</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="n">K</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">n_init</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>  <span class="c1"># ganti ke 10 jika sklearn &lt;1.4</span>
<span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>

<span class="c1"># Cetak metrik clustering</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah iterasi sampai konvergen: </span><span class="si">{</span><span class="n">kmeans</span><span class="o">.</span><span class="n">n_iter_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inertia (SSE): </span><span class="si">{</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sil_score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{</span><span class="n">sil_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Mapping cluster ke class mayoritas</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
      <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>

<span class="c1"># Siapkan untuk evaluasi</span>
<span class="n">y_true</span>   <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
<span class="n">y_pred</span>   <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span>
<span class="n">classes</span>  <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">cm</span>       <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>

<span class="c1"># Akurasi keseluruhan</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Akurasi keseluruhan clustering terhadap label asli: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.4%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Persentase error per kelas</span>
<span class="n">error_per_class</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
    <span class="n">total</span>   <span class="o">=</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">error</span>   <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">correct</span><span class="o">/</span><span class="n">total</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">error_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">error</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Persentase kesalahan per kelas:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">error_per_class</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Distribusi cluster per kelas (insight)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">],</span> 
                   <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">],</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribusi cluster per kelas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

<span class="c1"># Simpan hasil lengkap ke Excel</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;hasil_clustering_dengan_class_lengkap.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Tampilkan perbandingan class vs cluster vs predicted_class</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Perbandingan lengkap:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_class&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah iterasi sampai konvergen: 3
Inertia (SSE): 7.1386
Silhouette Score: 0.4825

Akurasi keseluruhan clustering terhadap label asli: 88.0000%

Persentase kesalahan per kelas:
 - Iris-setosa: 0.00%
 - Iris-versicolor: 20.00%
 - Iris-virginica: 16.00%

Distribusi cluster per kelas:
Cluster           0   1   2
Class                      
Iris-setosa       0  50   0
Iris-versicolor  10   0  40
Iris-virginica   42   0   8

Perbandingan lengkap:
               class  cluster  predicted_class
0        Iris-setosa        1      Iris-setosa
1        Iris-setosa        1      Iris-setosa
2        Iris-setosa        1      Iris-setosa
3        Iris-setosa        1      Iris-setosa
4        Iris-setosa        1      Iris-setosa
5        Iris-setosa        1      Iris-setosa
6        Iris-setosa        1      Iris-setosa
7        Iris-setosa        1      Iris-setosa
8        Iris-setosa        1      Iris-setosa
9        Iris-setosa        1      Iris-setosa
10       Iris-setosa        1      Iris-setosa
11       Iris-setosa        1      Iris-setosa
12       Iris-setosa        1      Iris-setosa
13       Iris-setosa        1      Iris-setosa
14       Iris-setosa        1      Iris-setosa
15       Iris-setosa        1      Iris-setosa
16       Iris-setosa        1      Iris-setosa
17       Iris-setosa        1      Iris-setosa
18       Iris-setosa        1      Iris-setosa
19       Iris-setosa        1      Iris-setosa
20       Iris-setosa        1      Iris-setosa
21       Iris-setosa        1      Iris-setosa
22       Iris-setosa        1      Iris-setosa
23       Iris-setosa        1      Iris-setosa
24       Iris-setosa        1      Iris-setosa
25       Iris-setosa        1      Iris-setosa
26       Iris-setosa        1      Iris-setosa
27       Iris-setosa        1      Iris-setosa
28       Iris-setosa        1      Iris-setosa
29       Iris-setosa        1      Iris-setosa
30       Iris-setosa        1      Iris-setosa
31       Iris-setosa        1      Iris-setosa
32       Iris-setosa        1      Iris-setosa
33       Iris-setosa        1      Iris-setosa
34       Iris-setosa        1      Iris-setosa
35       Iris-setosa        1      Iris-setosa
36       Iris-setosa        1      Iris-setosa
37       Iris-setosa        1      Iris-setosa
38       Iris-setosa        1      Iris-setosa
39       Iris-setosa        1      Iris-setosa
40       Iris-setosa        1      Iris-setosa
41       Iris-setosa        1      Iris-setosa
42       Iris-setosa        1      Iris-setosa
43       Iris-setosa        1      Iris-setosa
44       Iris-setosa        1      Iris-setosa
45       Iris-setosa        1      Iris-setosa
46       Iris-setosa        1      Iris-setosa
47       Iris-setosa        1      Iris-setosa
48       Iris-setosa        1      Iris-setosa
49       Iris-setosa        1      Iris-setosa
50   Iris-versicolor        0   Iris-virginica
51   Iris-versicolor        0   Iris-virginica
52   Iris-versicolor        0   Iris-virginica
53   Iris-versicolor        2  Iris-versicolor
54   Iris-versicolor        2  Iris-versicolor
55   Iris-versicolor        2  Iris-versicolor
56   Iris-versicolor        0   Iris-virginica
57   Iris-versicolor        2  Iris-versicolor
58   Iris-versicolor        2  Iris-versicolor
59   Iris-versicolor        2  Iris-versicolor
60   Iris-versicolor        2  Iris-versicolor
61   Iris-versicolor        2  Iris-versicolor
62   Iris-versicolor        2  Iris-versicolor
63   Iris-versicolor        2  Iris-versicolor
64   Iris-versicolor        2  Iris-versicolor
65   Iris-versicolor        0   Iris-virginica
66   Iris-versicolor        2  Iris-versicolor
67   Iris-versicolor        2  Iris-versicolor
68   Iris-versicolor        2  Iris-versicolor
69   Iris-versicolor        2  Iris-versicolor
70   Iris-versicolor        0   Iris-virginica
71   Iris-versicolor        2  Iris-versicolor
72   Iris-versicolor        2  Iris-versicolor
73   Iris-versicolor        2  Iris-versicolor
74   Iris-versicolor        2  Iris-versicolor
75   Iris-versicolor        2  Iris-versicolor
76   Iris-versicolor        0   Iris-virginica
77   Iris-versicolor        0   Iris-virginica
78   Iris-versicolor        2  Iris-versicolor
79   Iris-versicolor        2  Iris-versicolor
80   Iris-versicolor        2  Iris-versicolor
81   Iris-versicolor        2  Iris-versicolor
82   Iris-versicolor        2  Iris-versicolor
83   Iris-versicolor        2  Iris-versicolor
84   Iris-versicolor        2  Iris-versicolor
85   Iris-versicolor        0   Iris-virginica
86   Iris-versicolor        0   Iris-virginica
87   Iris-versicolor        2  Iris-versicolor
88   Iris-versicolor        2  Iris-versicolor
89   Iris-versicolor        2  Iris-versicolor
90   Iris-versicolor        2  Iris-versicolor
91   Iris-versicolor        2  Iris-versicolor
92   Iris-versicolor        2  Iris-versicolor
93   Iris-versicolor        2  Iris-versicolor
94   Iris-versicolor        2  Iris-versicolor
95   Iris-versicolor        2  Iris-versicolor
96   Iris-versicolor        2  Iris-versicolor
97   Iris-versicolor        2  Iris-versicolor
98   Iris-versicolor        2  Iris-versicolor
99   Iris-versicolor        2  Iris-versicolor
100   Iris-virginica        0   Iris-virginica
101   Iris-virginica        2  Iris-versicolor
102   Iris-virginica        0   Iris-virginica
103   Iris-virginica        0   Iris-virginica
104   Iris-virginica        0   Iris-virginica
105   Iris-virginica        0   Iris-virginica
106   Iris-virginica        2  Iris-versicolor
107   Iris-virginica        0   Iris-virginica
108   Iris-virginica        0   Iris-virginica
109   Iris-virginica        0   Iris-virginica
110   Iris-virginica        0   Iris-virginica
111   Iris-virginica        0   Iris-virginica
112   Iris-virginica        0   Iris-virginica
113   Iris-virginica        2  Iris-versicolor
114   Iris-virginica        0   Iris-virginica
115   Iris-virginica        0   Iris-virginica
116   Iris-virginica        0   Iris-virginica
117   Iris-virginica        0   Iris-virginica
118   Iris-virginica        0   Iris-virginica
119   Iris-virginica        2  Iris-versicolor
120   Iris-virginica        0   Iris-virginica
121   Iris-virginica        2  Iris-versicolor
122   Iris-virginica        0   Iris-virginica
123   Iris-virginica        0   Iris-virginica
124   Iris-virginica        0   Iris-virginica
125   Iris-virginica        0   Iris-virginica
126   Iris-virginica        0   Iris-virginica
127   Iris-virginica        0   Iris-virginica
128   Iris-virginica        0   Iris-virginica
129   Iris-virginica        0   Iris-virginica
130   Iris-virginica        0   Iris-virginica
131   Iris-virginica        0   Iris-virginica
132   Iris-virginica        0   Iris-virginica
133   Iris-virginica        2  Iris-versicolor
134   Iris-virginica        2  Iris-versicolor
135   Iris-virginica        0   Iris-virginica
136   Iris-virginica        0   Iris-virginica
137   Iris-virginica        0   Iris-virginica
138   Iris-virginica        0   Iris-virginica
139   Iris-virginica        0   Iris-virginica
140   Iris-virginica        0   Iris-virginica
141   Iris-virginica        0   Iris-virginica
142   Iris-virginica        2  Iris-versicolor
143   Iris-virginica        0   Iris-virginica
144   Iris-virginica        0   Iris-virginica
145   Iris-virginica        0   Iris-virginica
146   Iris-virginica        0   Iris-virginica
147   Iris-virginica        0   Iris-virginica
148   Iris-virginica        0   Iris-virginica
149   Iris-virginica        0   Iris-virginica
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>4 Klaster<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Baca data fitur dan label</span>
<span class="n">df_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;data_iris.xlsx&quot;</span><span class="p">)</span>
<span class="n">df_class</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;class.xlsx&quot;</span><span class="p">)</span>  <span class="c1"># kolom &#39;class&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_class</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>

<span class="c1"># Ambil fitur untuk clustering</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">]]</span>

<span class="c1"># Normalisasi fitur(MinMax)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaled_features</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># KMeans clustering</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah iterasi sampai konvergen: </span><span class="si">{</span><span class="n">kmeans</span><span class="o">.</span><span class="n">n_iter_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inertia (SSE): </span><span class="si">{</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sil_score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{</span><span class="n">sil_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Mapping cluster ke class mayoritas</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>

<span class="c1"># Evaluasi</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Akurasi keseluruhan clustering terhadap label asli: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.4%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Distribusi cluster per kelas (untuk insight)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">],</span> <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">],</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribusi cluster per kelas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

<span class="c1"># Simpan hasil ke Excel</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;hasil4.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Kalau ingin tampil semua baris (hati-hati jika data sangat banyak)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_class&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah iterasi sampai konvergen: 6
Inertia (SSE): 5.5417
Silhouette Score: 0.4435

Akurasi keseluruhan clustering terhadap label asli: 84.6667%

Distribusi cluster per kelas:
Cluster           0   1   2   3
Class                          
Iris-setosa       0  50   0   0
Iris-versicolor  21   0  29   0
Iris-virginica   21   0   2  27
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               class  cluster  predicted_class
0        Iris-setosa        1      Iris-setosa
1        Iris-setosa        1      Iris-setosa
2        Iris-setosa        1      Iris-setosa
3        Iris-setosa        1      Iris-setosa
4        Iris-setosa        1      Iris-setosa
5        Iris-setosa        1      Iris-setosa
6        Iris-setosa        1      Iris-setosa
7        Iris-setosa        1      Iris-setosa
8        Iris-setosa        1      Iris-setosa
9        Iris-setosa        1      Iris-setosa
10       Iris-setosa        1      Iris-setosa
11       Iris-setosa        1      Iris-setosa
12       Iris-setosa        1      Iris-setosa
13       Iris-setosa        1      Iris-setosa
14       Iris-setosa        1      Iris-setosa
15       Iris-setosa        1      Iris-setosa
16       Iris-setosa        1      Iris-setosa
17       Iris-setosa        1      Iris-setosa
18       Iris-setosa        1      Iris-setosa
19       Iris-setosa        1      Iris-setosa
20       Iris-setosa        1      Iris-setosa
21       Iris-setosa        1      Iris-setosa
22       Iris-setosa        1      Iris-setosa
23       Iris-setosa        1      Iris-setosa
24       Iris-setosa        1      Iris-setosa
25       Iris-setosa        1      Iris-setosa
26       Iris-setosa        1      Iris-setosa
27       Iris-setosa        1      Iris-setosa
28       Iris-setosa        1      Iris-setosa
29       Iris-setosa        1      Iris-setosa
30       Iris-setosa        1      Iris-setosa
31       Iris-setosa        1      Iris-setosa
32       Iris-setosa        1      Iris-setosa
33       Iris-setosa        1      Iris-setosa
34       Iris-setosa        1      Iris-setosa
35       Iris-setosa        1      Iris-setosa
36       Iris-setosa        1      Iris-setosa
37       Iris-setosa        1      Iris-setosa
38       Iris-setosa        1      Iris-setosa
39       Iris-setosa        1      Iris-setosa
40       Iris-setosa        1      Iris-setosa
41       Iris-setosa        1      Iris-setosa
42       Iris-setosa        1      Iris-setosa
43       Iris-setosa        1      Iris-setosa
44       Iris-setosa        1      Iris-setosa
45       Iris-setosa        1      Iris-setosa
46       Iris-setosa        1      Iris-setosa
47       Iris-setosa        1      Iris-setosa
48       Iris-setosa        1      Iris-setosa
49       Iris-setosa        1      Iris-setosa
50   Iris-versicolor        0  Iris-versicolor
51   Iris-versicolor        0  Iris-versicolor
52   Iris-versicolor        0  Iris-versicolor
53   Iris-versicolor        2  Iris-versicolor
54   Iris-versicolor        0  Iris-versicolor
55   Iris-versicolor        2  Iris-versicolor
56   Iris-versicolor        0  Iris-versicolor
57   Iris-versicolor        2  Iris-versicolor
58   Iris-versicolor        0  Iris-versicolor
59   Iris-versicolor        2  Iris-versicolor
60   Iris-versicolor        2  Iris-versicolor
61   Iris-versicolor        0  Iris-versicolor
62   Iris-versicolor        2  Iris-versicolor
63   Iris-versicolor        0  Iris-versicolor
64   Iris-versicolor        2  Iris-versicolor
65   Iris-versicolor        0  Iris-versicolor
66   Iris-versicolor        2  Iris-versicolor
67   Iris-versicolor        2  Iris-versicolor
68   Iris-versicolor        2  Iris-versicolor
69   Iris-versicolor        2  Iris-versicolor
70   Iris-versicolor        0  Iris-versicolor
71   Iris-versicolor        2  Iris-versicolor
72   Iris-versicolor        0  Iris-versicolor
73   Iris-versicolor        2  Iris-versicolor
74   Iris-versicolor        0  Iris-versicolor
75   Iris-versicolor        0  Iris-versicolor
76   Iris-versicolor        0  Iris-versicolor
77   Iris-versicolor        0  Iris-versicolor
78   Iris-versicolor        0  Iris-versicolor
79   Iris-versicolor        2  Iris-versicolor
80   Iris-versicolor        2  Iris-versicolor
81   Iris-versicolor        2  Iris-versicolor
82   Iris-versicolor        2  Iris-versicolor
83   Iris-versicolor        0  Iris-versicolor
84   Iris-versicolor        2  Iris-versicolor
85   Iris-versicolor        0  Iris-versicolor
86   Iris-versicolor        0  Iris-versicolor
87   Iris-versicolor        2  Iris-versicolor
88   Iris-versicolor        2  Iris-versicolor
89   Iris-versicolor        2  Iris-versicolor
90   Iris-versicolor        2  Iris-versicolor
91   Iris-versicolor        0  Iris-versicolor
92   Iris-versicolor        2  Iris-versicolor
93   Iris-versicolor        2  Iris-versicolor
94   Iris-versicolor        2  Iris-versicolor
95   Iris-versicolor        2  Iris-versicolor
96   Iris-versicolor        2  Iris-versicolor
97   Iris-versicolor        0  Iris-versicolor
98   Iris-versicolor        2  Iris-versicolor
99   Iris-versicolor        2  Iris-versicolor
100   Iris-virginica        3   Iris-virginica
101   Iris-virginica        0  Iris-versicolor
102   Iris-virginica        3   Iris-virginica
103   Iris-virginica        0  Iris-versicolor
104   Iris-virginica        3   Iris-virginica
105   Iris-virginica        3   Iris-virginica
106   Iris-virginica        2  Iris-versicolor
107   Iris-virginica        3   Iris-virginica
108   Iris-virginica        0  Iris-versicolor
109   Iris-virginica        3   Iris-virginica
110   Iris-virginica        0  Iris-versicolor
111   Iris-virginica        0  Iris-versicolor
112   Iris-virginica        3   Iris-virginica
113   Iris-virginica        0  Iris-versicolor
114   Iris-virginica        0  Iris-versicolor
115   Iris-virginica        3   Iris-virginica
116   Iris-virginica        0  Iris-versicolor
117   Iris-virginica        3   Iris-virginica
118   Iris-virginica        3   Iris-virginica
119   Iris-virginica        2  Iris-versicolor
120   Iris-virginica        3   Iris-virginica
121   Iris-virginica        0  Iris-versicolor
122   Iris-virginica        3   Iris-virginica
123   Iris-virginica        0  Iris-versicolor
124   Iris-virginica        3   Iris-virginica
125   Iris-virginica        3   Iris-virginica
126   Iris-virginica        0  Iris-versicolor
127   Iris-virginica        0  Iris-versicolor
128   Iris-virginica        0  Iris-versicolor
129   Iris-virginica        3   Iris-virginica
130   Iris-virginica        3   Iris-virginica
131   Iris-virginica        3   Iris-virginica
132   Iris-virginica        3   Iris-virginica
133   Iris-virginica        0  Iris-versicolor
134   Iris-virginica        0  Iris-versicolor
135   Iris-virginica        3   Iris-virginica
136   Iris-virginica        3   Iris-virginica
137   Iris-virginica        0  Iris-versicolor
138   Iris-virginica        0  Iris-versicolor
139   Iris-virginica        3   Iris-virginica
140   Iris-virginica        3   Iris-virginica
141   Iris-virginica        3   Iris-virginica
142   Iris-virginica        0  Iris-versicolor
143   Iris-virginica        3   Iris-virginica
144   Iris-virginica        3   Iris-virginica
145   Iris-virginica        3   Iris-virginica
146   Iris-virginica        0  Iris-versicolor
147   Iris-virginica        0  Iris-versicolor
148   Iris-virginica        3   Iris-virginica
149   Iris-virginica        0  Iris-versicolor
</pre></div>
</div>
</div>
</div>
<p>Kesimpulan :</p>
<ol class="arabic simple">
<li><p>K = 2<br />
Inertia (SSE): 12.1437<br />
Silhouette Score: 0.6295</p></li>
</ol>
<ul class="simple">
<li><p>Nilai skor inertia lebih besar dari yang lain dan nilai skor silhouette yang diperoleh adalah yang tertinggi dibandingkan dengan K lainnya (lebih mendekati 1).</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>K = 3<br />
Inertia (SSE): 7.1386<br />
Silhouette Score: 0.4825</p></li>
</ol>
<ul class="simple">
<li><p>Nilai skor inertia turun dan nilai skor silhouette juga mengalami penurunan dibandingkan dengan k=2 (menjauh dari 1).</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>K =4<br />
Inertia (SSE): 5.5417<br />
Silhouette Score: 0.4435</p></li>
</ol>
<ul class="simple">
<li><p>Nilai skor inertia dan nilai skor silhouette sama-sama mengalami penurunan (semakin jauh dari 1).</p></li>
</ul>
<p>Maka berdasarkan hasil evaluasi yang telah dilakukan, nilai K = 2 merupakan jumlah klaster yang paling optimal. Hal ini ditunjukkan oleh nilai silhouette score paling mendekati 1 (0.6295).</p>
</section>
</section>
<section id="metode-elbow">
<h2>Metode Elbow<a class="headerlink" href="#metode-elbow" title="Link to this heading">#</a></h2>
<p>Metode Elbow untuk menentukan jumlah klaster ð‘˜ yang optimal dengan memantau penurunan nilai inertia seiring bertambahnya ð‘˜. Titik sebelum grafik melandai adalah titik siku (elbow point) â†’ yaitu jumlah klaster optimal.</p>
<p>Contoh Elbow Method :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data_iris.xlsx&#39;</span><span class="p">)</span>
<span class="n">iris_x</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">iris_x</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">x_iris</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">iris_x</span><span class="p">)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">x_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_iris</span><span class="p">)</span>
<span class="n">x_scaled</span>

<span class="n">wcss</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">km</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris_x</span><span class="p">)</span>
    <span class="n">wcss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">km</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wcss</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span><span class="n">wcss</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;WCSS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;No. of Clusters (k)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The Elbow Method&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3a7043c39ef19240c8be32b053b50c59ccb56e6c67a3ec6cbb74647a8f4119a7.png" src="_images/3a7043c39ef19240c8be32b053b50c59ccb56e6c67a3ec6cbb74647a8f4119a7.png" />
</div>
</div>
<ul class="simple">
<li><p>Berdasarkan metode Elbow, jumlah klaster optimal adalah K = 3, karena pada titik ini terjadi penurunan WCSS (Within-Cluster Sum of Squares) yang signifikan sebelum grafik mulai melandai.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fuzzy-c-mean">
<h1>Fuzzy C-mean<a class="headerlink" href="#fuzzy-c-mean" title="Link to this heading">#</a></h1>
<section id="konsep-fuzzy-c-mean">
<h2>Konsep Fuzzy C-mean<a class="headerlink" href="#konsep-fuzzy-c-mean" title="Link to this heading">#</a></h2>
<p>Fuzzy C-Means merupakan algoritma yang termasuk dalam kategori soft clustering, di mana setiap data dapat menjadi anggota dari lebih dari satu klaster secara bersamaan. Berbeda dengan hard clustering yang hanya menetapkan satu klaster untuk setiap data, Fuzzy C-Means menghitung derajat keanggotaan (membership value) dari setiap data terhadap seluruh klaster, dengan nilai antara 0 hingga 1. Penentuan klaster utama untuk suatu data dilakukan berdasarkan nilai derajat keanggotaan tertinggi. Pada tahap inisialisasi, jumlah total derajat keanggotaan dari satu data terhadap seluruh klaster adalah 1, yang mencerminkan distribusi keanggotaannya di semua klaster.</p>
</section>
<section id="langkah-langkah">
<h2>Langkah-langkah<a class="headerlink" href="#langkah-langkah" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Tentukan jumlah klaster <span class="math notranslate nohighlight">\(C\)</span>, nilai fuzzifier <span class="math notranslate nohighlight">\(m\)</span>, dan inisialisasi nilai derajat keanggotaan awal secara acak dimana jumlah semua nilai keanggotaan untuk satu baris data terhadap seluruh klaster harus sama dengan 1.</p></li>
<li><p>Hitung pusat setiap klaster</p></li>
</ol>
<ul class="simple">
<li><p>Rumus :<br />
$<span class="math notranslate nohighlight">\(v_i = \frac{\sum_{k=1}^{n} u_{ik}^m x_k}{\sum_{k=1}^{n} u_{ik}^m}\)</span>$</p></li>
<li><p>Penjelasan :<br />
<span class="math notranslate nohighlight">\(v_{i}\)</span> : pusat klaster ke-i (centroid).<br />
<span class="math notranslate nohighlight">\(u_{ik}\)</span> : derajat keanggotaan data ke-k terhadap klaster ke-i.<br />
<span class="math notranslate nohighlight">\(m\)</span> : nilai fuzzifier.<br />
<span class="math notranslate nohighlight">\(x_{k}\)</span> : data ke-k.<br />
<span class="math notranslate nohighlight">\(n\)</span> : jumlah total data.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Hitung jarak titik setiap data dari centroid menggunakan rumus Euclidian distance karena dibutuhkan untuk perhitungan update derajat keanggotaan.</p></li>
</ol>
<ul class="simple">
<li><p>Rumus :<br />
$<span class="math notranslate nohighlight">\(d(A, B) = \sqrt{ \sum_{i=1}^{n} (x_i - y_i)^2 }\)</span>$</p></li>
<li><p>Penjelasan :<br />
<span class="math notranslate nohighlight">\(d(A,B)\)</span> :  jarak antara vektor <span class="math notranslate nohighlight">\(A\)</span> dan <span class="math notranslate nohighlight">\(B\)</span>.
<span class="math notranslate nohighlight">\(x_{i}, y_{i}\)</span> : komponen ke-<span class="math notranslate nohighlight">\(i\)</span> dari masing-masing vektor.<br />
<span class="math notranslate nohighlight">\(n\)</span> : jumlah total data.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Update derajat keanggotaan</p></li>
</ol>
<ul class="simple">
<li><p>Rumus :<br />
$<span class="math notranslate nohighlight">\(u_{ik} = \frac{1}{\sum_{j=1}^{c} \left( \frac{\lVert x_k - v_i \rVert}{\lVert x_k - v_j \rVert} \right)^{\frac{2}{m-1}}}
\)</span>$</p></li>
<li><p>Penjelasan :<br />
<span class="math notranslate nohighlight">\(u_{ik}\)</span> : derajat keanggotaan data ke-k terhadap klaster ke-i.<br />
<span class="math notranslate nohighlight">\(x_{k}\)</span> : data ke-k.<br />
<span class="math notranslate nohighlight">\(v_{i},v_{j}\)</span> : pusat klaster ke-i dan ke-j<br />
<span class="math notranslate nohighlight">\(||.||\)</span> : jarak Euclidean antara titik dan pusat klaster.<br />
<span class="math notranslate nohighlight">\(m\)</span> : nilai fuzzifier.<br />
<span class="math notranslate nohighlight">\(c\)</span> : jumlah klaster.</p></li>
<li><p>Jika <span class="math notranslate nohighlight">\(m\)</span> = 2, maka pangkatnya bisa menjadi 2.</p></li>
<li><p>Misalnya hitung <span class="math notranslate nohighlight">\(u_{11}\)</span>, artinya hitung derajat keanggotaan data ke 1 pada klaster 1.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Ulangi langkah 2 hingga 4 secara iteratif hingga mencapai kondisi konvergen, yaitu ketika perubahan yang terjadi pada nilai pusat klaster atau derajat keanggotaan antar iterasi sangat kecil atau tidak signifikan lagi. Pada titik ini, proses klasterisasi dianggap telah mencapai hasil yang optimal.</p></li>
<li><p>Cek Konvergensi dengan fungsi objektif dengan membandingkan nilai fungsi objektif pada dua iterasi berurutan.</p></li>
</ol>
<ul class="simple">
<li><p>Rumus :<br />
$<span class="math notranslate nohighlight">\(J_m = \sum_{k=1}^{n} \sum_{i=1}^{c} u_{ik}^m \cdot \|x_k - v_i\|^2\)</span>$</p></li>
<li><p>Penjelasan :<br />
<span class="math notranslate nohighlight">\(u_{ik}\)</span> : derajat keanggotaan data ke-k terhadap klaster ke-i.<br />
<span class="math notranslate nohighlight">\(m\)</span> : nilai fuzzifier.<br />
<span class="math notranslate nohighlight">\(x_{k}\)</span> : data ke-k.<br />
<span class="math notranslate nohighlight">\(v_{i}\)</span> : pusat klaster ke-i (centroid).<br />
<span class="math notranslate nohighlight">\(||x_{k}-v_{i}||\)</span>: jarak (umumnya menggunakan euclidean distance)</p></li>
<li><p>Jika selisih dari dua iterasi berturut-turut lebih kecil dari batas toleransi misalnya 0,00001, maka dianggap sudah konvergen dan iterasi berhenti.</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>Menentukan klaster terakhir setelah proses iterasi selesai (konvergen), maka selanjutnya mengklasifikasi setiap data pada suatu klaster dengan cara: menentukan kluster dengan nilai <span class="math notranslate nohighlight">\(u_{ij}\)</span> tertinggi untuk data tersebut. Misalnya untuk data <span class="math notranslate nohighlight">\(x_{i}\)</span> diperoleh derajat keanggotaan :</p></li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(u_{11}\)</span> = 0,2</p></li>
<li><p><span class="math notranslate nohighlight">\(u_{21}\)</span> = 0,7</p></li>
<li><p><span class="math notranslate nohighlight">\(u_{31}\)</span> = 0,1</p></li>
</ul>
<p>Maka kluster utama untuk <span class="math notranslate nohighlight">\(x_{1}\)</span> adalah kluster ke-2, karena <span class="math notranslate nohighlight">\(u_{21}\)</span> adalah yang terbesar.</p>
</section>
<section id="komputasi-fuzzy-c-mean">
<h2>Komputasi Fuzzy C-mean<a class="headerlink" href="#komputasi-fuzzy-c-mean" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>m = 2</p></li>
<li><p>maksimal iterasi = 100</p></li>
<li><p>epsilon (batas toleransi) = 0,00001</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Data xi</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Matriks keanggotaan awal U (acak)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Parameter</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>            <span class="c1"># Fuzziness</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Maksimum iterasi</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span>  <span class="c1"># Toleransi konvergensi 0.00001</span>

<span class="k">def</span> <span class="nf">calculate_centroids</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">um</span> <span class="o">=</span> <span class="n">U</span> <span class="o">**</span> <span class="n">m</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">um</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">um</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">update_membership</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">U_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">num</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
            <span class="n">U_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="k">return</span> <span class="n">U_new</span>

<span class="k">def</span> <span class="nf">calculate_objective_function</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
               <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Iterasi Fuzzy C-Means dengan detail output</span>
<span class="n">prev_obj</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">calculate_centroids</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">update_membership</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">calculate_objective_function</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

    <span class="c1"># Cetak detail iterasi</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Iterasi </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Centroids:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Objektif J_m:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keanggotaan U:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Cek konvergensi</span>
    <span class="k">if</span> <span class="n">prev_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">obj</span> <span class="o">-</span> <span class="n">prev_obj</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Konvergen pada iterasi ke-</span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2"> (Î”J = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev_obj</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> &lt; </span><span class="si">{</span><span class="n">epsilon</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="n">prev_obj</span> <span class="o">=</span> <span class="n">obj</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maksimum iterasi tercapai tanpa konvergensi.&quot;</span><span class="p">)</span>

<span class="c1"># Hasil akhir (jika belum tercetak oleh break)</span>
<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">obj</span> <span class="o">-</span> <span class="n">prev_obj</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">epsilon</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Hasil Akhir ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Centroids Akhir:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keanggotaan Akhir (U):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Nilai Fungsi Objektif Akhir:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Iterasi 1 ---
Centroids:
[[3.861  4.861 ]
 [3.5079 4.5079]]
Objektif J_m: 26.410066
Keanggotaan U:
[[0.4345 0.5655]
 [0.3963 0.6037]
 [0.2582 0.7418]
 [0.5758 0.4242]
 [0.5531 0.4469]]

--- Iterasi 2 ---
Centroids:
[[4.6034 5.6034]
 [3.2074 4.2074]]
Objektif J_m: 20.900504
Keanggotaan U:
[[0.2729 0.7271]
 [0.177  0.823 ]
 [0.0165 0.9835]
 [0.7999 0.2001]
 [0.7146 0.2854]]

--- Iterasi 3 ---
Centroids:
[[6.0097 7.0097]
 [2.4384 3.4384]]
Objektif J_m: 6.68533
Keanggotaan U:
[[0.0762 0.9238]
 [0.0118 0.9882]
 [0.0337 0.9663]
 [1.     0.    ]
 [0.955  0.045 ]]

--- Iterasi 4 ---
Centroids:
[[6.4581 7.4581]
 [2.0327 3.0327]]
Objektif J_m: 4.791511
Keanggotaan U:
[[3.460e-02 9.654e-01]
 [1.000e-04 9.999e-01]
 [7.260e-02 9.274e-01]
 [9.868e-01 1.320e-02]
 [9.882e-01 1.180e-02]]

--- Iterasi 5 ---
Centroids:
[[6.4879 7.4879]
 [1.9747 2.9747]]
Objektif J_m: 4.766811
Keanggotaan U:
[[0.0306 0.9694]
 [0.     1.    ]
 [0.0795 0.9205]
 [0.9855 0.0145]
 [0.9897 0.0103]]

--- Iterasi 6 ---
Centroids:
[[6.4882 7.4882]
 [1.9673 2.9673]]
Objektif J_m: 4.766461
Keanggotaan U:
[[3.010e-02 9.699e-01]
 [1.000e-04 9.999e-01]
 [8.060e-02 9.194e-01]
 [9.856e-01 1.440e-02]
 [9.898e-01 1.020e-02]]

--- Iterasi 7 ---
Centroids:
[[6.488  7.488 ]
 [1.9663 2.9663]]
Objektif J_m: 4.766454
Keanggotaan U:
[[3.010e-02 9.699e-01]
 [1.000e-04 9.999e-01]
 [8.070e-02 9.193e-01]
 [9.856e-01 1.440e-02]
 [9.898e-01 1.020e-02]]

Konvergen pada iterasi ke-7 (Î”J = 0.000007 &lt; 1e-05)
</pre></div>
</div>
</div>
</div>
<p>Link perhitungan manual hanya sampai dua iterasi :<br />
<a class="reference external" href="https://docs.google.com/spreadsheets/d/1wLilhPFjf0tFwQjRFbflKhPWY88ZvvkZ3B9bXPkLoxw/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1wLilhPFjf0tFwQjRFbflKhPWY88ZvvkZ3B9bXPkLoxw/edit?usp=sharing</a></p>
</section>
<section id="implementasi-data-iris-3-klaster">
<h2>Implementasi data iris 3 klaster<a class="headerlink" href="#implementasi-data-iris-3-klaster" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>n_cluster = 3</p></li>
<li><p>m = 2</p></li>
<li><p>epsilon = 0,00001</p></li>
<li><p>maksimal iterasi = 150</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">fcmeans</span> <span class="kn">import</span> <span class="n">FCM</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>

<span class="c1"># 1. Baca dan siapkan data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;class.xlsx&quot;</span><span class="p">)</span>  
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># 2. Normalisasi Minâ€“Max</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># 3. Fuzzy C-Means clustering</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">fcm</span> <span class="o">=</span> <span class="n">FCM</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">fcm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>

<span class="c1"># 4. Hasil prediksi</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">fcm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">fcm</span><span class="o">.</span><span class="n">u</span>
<span class="n">centers</span> <span class="o">=</span> <span class="n">fcm</span><span class="o">.</span><span class="n">centers</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>

<span class="c1"># 5. Silhouette Score</span>
<span class="n">sil_score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Silhouette Score: </span><span class="si">{</span><span class="n">sil_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 6. Inertia (dengan label keras)</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_scaled</span> <span class="o">-</span> <span class="n">centers</span><span class="p">[</span><span class="n">labels</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inertia (crisp): </span><span class="si">{</span><span class="n">inertia</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 7. Fungsi Objektif J_m</span>
<span class="n">dist_matrix</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
<span class="n">Jm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">U</span><span class="o">**</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dist_matrix</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FCM Objective J_m: </span><span class="si">{</span><span class="n">Jm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 8. Gabungkan hasil ke DataFrame</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
    <span class="s1">&#39;cluster&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span>  <span class="c1"># â† Tambahkan ini</span>
<span class="p">})</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">result_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;membership_cluster_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Hasil Clustering (epsilon: </span><span class="si">{</span><span class="n">epsilon</span><span class="si">}</span><span class="s2">) ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>


<span class="c1"># 9. Mapping cluster ke class mayoritas</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
      <span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>

<span class="c1"># 10. Evaluasi</span>
<span class="n">y_true</span>   <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
<span class="n">y_pred</span>   <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;predicted_class&#39;</span><span class="p">]</span>
<span class="n">classes</span>  <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">cm</span>       <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>

<span class="c1"># Akurasi keseluruhan</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Akurasi keseluruhan clustering terhadap label asli: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.4%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Persentase error per kelas</span>
<span class="n">error_per_class</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
    <span class="n">total</span>   <span class="o">=</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">error</span>   <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">correct</span><span class="o">/</span><span class="n">total</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">error_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">error</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Persentase kesalahan per kelas:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">error_per_class</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Distribusi cluster per kelas (insight)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">],</span> 
                   <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">],</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distribusi cluster per kelas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

<span class="c1"># Simpan hasil lengkap ke Excel</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;hasil_fuzzy.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Tampilkan perbandingan class vs cluster vs predicted_class</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Perbandingan lengkap:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_class&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Silhouette Score: 0.4955
Inertia (crisp): 7.0830
FCM Objective J_m: 5.2330

--- Hasil Clustering (epsilon: 1e-05) ---
 id  cluster  membership_cluster_0  membership_cluster_1  membership_cluster_2
  1        0                0.9930                0.0023                0.0048
  2        0                0.9313                0.0204                0.0483
  3        0                0.9660                0.0105                0.0235
  4        0                0.9371                0.0191                0.0439
  5        0                0.9839                0.0053                0.0108
  6        0                0.8700                0.0450                0.0850
  7        0                0.9711                0.0091                0.0198
  8        0                0.9989                0.0003                0.0008
  9        0                0.8635                0.0413                0.0952
 10        0                0.9534                0.0141                0.0325
 11        0                0.9390                0.0205                0.0405
 12        0                0.9907                0.0029                0.0064
 13        0                0.9251                0.0227                0.0522
 14        0                0.8778                0.0387                0.0835
 15        0                0.8158                0.0680                0.1162
 16        0                0.7127                0.1135                0.1738
 17        0                0.8806                0.0420                0.0775
 18        0                0.9927                0.0023                0.0050
 19        0                0.8550                0.0499                0.0951
 20        0                0.9397                0.0205                0.0398
 21        0                0.9636                0.0113                0.0251
 22        0                0.9531                0.0155                0.0315
 23        0                0.9529                0.0159                0.0312
 24        0                0.9548                0.0131                0.0321
 25        0                0.9791                0.0064                0.0145
 26        0                0.9278                0.0210                0.0512
 27        0                0.9884                0.0035                0.0081
 28        0                0.9878                0.0039                0.0083
 29        0                0.9911                0.0028                0.0061
 30        0                0.9651                0.0106                0.0243
 31        0                0.9523                0.0142                0.0335
 32        0                0.9550                0.0138                0.0312
 33        0                0.8579                0.0520                0.0901
 34        0                0.8063                0.0729                0.1208
 35        0                0.9534                0.0141                0.0325
 36        0                0.9771                0.0071                0.0158
 37        0                0.9493                0.0166                0.0342
 38        0                0.9534                0.0141                0.0325
 39        0                0.8913                0.0334                0.0753
 40        0                0.9971                0.0009                0.0020
 41        0                0.9928                0.0023                0.0049
 42        0                0.6619                0.0997                0.2384
 43        0                0.9297                0.0221                0.0482
 44        0                0.9349                0.0199                0.0451
 45        0                0.9129                0.0289                0.0582
 46        0                0.9237                0.0224                0.0539
 47        0                0.9408                0.0202                0.0391
 48        0                0.9565                0.0135                0.0300
 49        0                0.9508                0.0165                0.0327
 50        0                0.9939                0.0019                0.0042
 51        1                0.0659                0.5350                0.3990
 52        2                0.0521                0.3677                0.5802
 53        1                0.0453                0.6034                0.3513
 54        2                0.0669                0.1041                0.8290
 55        2                0.0321                0.2643                0.7036
 56        2                0.0079                0.0193                0.9728
 57        2                0.0519                0.4727                0.4753
 58        2                0.2488                0.1352                0.6160
 59        2                0.0472                0.2573                0.6955
 60        2                0.0704                0.0951                0.8345
 61        2                0.2198                0.1644                0.6158
 62        2                0.0238                0.0843                0.8919
 63        2                0.0996                0.1397                0.7607
 64        2                0.0166                0.0841                0.8992
 65        2                0.0598                0.0744                0.8658
 66        2                0.0599                0.3774                0.5627
 67        2                0.0311                0.0981                0.8708
 68        2                0.0542                0.0675                0.8783
 69        2                0.0525                0.1986                0.7489
 70        2                0.0639                0.0753                0.8608
 71        2                0.0474                0.4434                0.5092
 72        2                0.0160                0.0401                0.9439
 73        2                0.0313                0.2043                0.7644
 74        2                0.0202                0.0646                0.9152
 75        2                0.0362                0.1413                0.8225
 76        2                0.0493                0.3004                0.6502
 77        2                0.0474                0.3981                0.5544
 78        1                0.0237                0.7364                0.2399
 79        2                0.0131                0.0648                0.9221
 80        2                0.1103                0.0922                0.7975
 81        2                0.0898                0.0963                0.8139
 82        2                0.1196                0.1063                0.7740
 83        2                0.0236                0.0365                0.9399
 84        2                0.0246                0.1982                0.7772
 85        2                0.0472                0.1203                0.8325
 86        2                0.0738                0.3699                0.5563
 87        1                0.0462                0.4997                0.4540
 88        2                0.0501                0.1543                0.7956
 89        2                0.0403                0.0685                0.8911
 90        2                0.0418                0.0654                0.8928
 91        2                0.0331                0.0550                0.9119
 92        2                0.0243                0.1155                0.8601
 93        2                0.0232                0.0385                0.9382
 94        2                0.2311                0.1384                0.6306
 95        2                0.0139                0.0261                0.9600
 96        2                0.0406                0.0669                0.8925
 97        2                0.0161                0.0326                0.9513
 98        2                0.0217                0.0729                0.9054
 99        2                0.2323                0.1272                0.6405
100        2                0.0109                0.0209                0.9681
101        1                0.0338                0.8200                0.1462
102        2                0.0389                0.3788                0.5824
103        1                0.0088                0.9449                0.0463
104        1                0.0208                0.7458                0.2334
105        1                0.0071                0.9480                0.0448
106        1                0.0380                0.8123                0.1497
107        2                0.0945                0.1962                0.7093
108        1                0.0293                0.8230                0.1477
109        1                0.0343                0.6766                0.2892
110        1                0.0473                0.7988                0.1539
111        1                0.0122                0.9007                0.0871
112        1                0.0233                0.7048                0.2719
113        1                0.0011                0.9916                0.0073
114        2                0.0509                0.3674                0.5817
115        1                0.0516                0.6175                0.3309
116        1                0.0173                0.8861                0.0966
117        1                0.0127                0.8654                0.1219
118        1                0.0737                0.7220                0.2043
119        1                0.0556                0.7361                0.2083
120        2                0.0518                0.2129                0.7353
121        1                0.0105                0.9399                0.0496
122        2                0.0499                0.3806                0.5696
123        1                0.0473                0.7645                0.1882
124        2                0.0291                0.4611                0.5098
125        1                0.0080                0.9502                0.0419
126        1                0.0225                0.8682                0.1094
127        2                0.0286                0.4177                0.5537
128        1                0.0312                0.4870                0.4818
129        1                0.0142                0.8710                0.1148
130        1                0.0331                0.7768                0.1900
131        1                0.0296                0.8226                0.1478
132        1                0.0809                0.7004                0.2187
133        1                0.0157                0.8697                0.1146
134        2                0.0282                0.2777                0.6942
135        2                0.0401                0.2616                0.6982
136        1                0.0384                0.8156                0.1459
137        1                0.0328                0.8213                0.1459
138        1                0.0160                0.8375                0.1465
139        2                0.0341                0.4040                0.5619
140        1                0.0027                0.9817                0.0156
141        1                0.0133                0.9203                0.0664
142        1                0.0130                0.9196                0.0674
143        2                0.0389                0.3788                0.5824
144        1                0.0108                0.9373                0.0518
145        1                0.0249                0.8698                0.1053
146        1                0.0106                0.9271                0.0622
147        1                0.0367                0.4890                0.4743
148        1                0.0077                0.9260                0.0663
149        1                0.0342                0.8014                0.1645
150        2                0.0358                0.4381                0.5261

Akurasi keseluruhan clustering terhadap label asli: 89.3333%

Persentase kesalahan per kelas:
 - Iris-setosa: 0.00%
 - Iris-versicolor: 8.00%
 - Iris-virginica: 24.00%

Distribusi cluster per kelas:
Cluster           0   1   2
Class                      
Iris-setosa      50   0   0
Iris-versicolor   0   4  46
Iris-virginica    0  38  12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Perbandingan lengkap:
               class  cluster  predicted_class
0        Iris-setosa        0      Iris-setosa
1        Iris-setosa        0      Iris-setosa
2        Iris-setosa        0      Iris-setosa
3        Iris-setosa        0      Iris-setosa
4        Iris-setosa        0      Iris-setosa
5        Iris-setosa        0      Iris-setosa
6        Iris-setosa        0      Iris-setosa
7        Iris-setosa        0      Iris-setosa
8        Iris-setosa        0      Iris-setosa
9        Iris-setosa        0      Iris-setosa
10       Iris-setosa        0      Iris-setosa
11       Iris-setosa        0      Iris-setosa
12       Iris-setosa        0      Iris-setosa
13       Iris-setosa        0      Iris-setosa
14       Iris-setosa        0      Iris-setosa
15       Iris-setosa        0      Iris-setosa
16       Iris-setosa        0      Iris-setosa
17       Iris-setosa        0      Iris-setosa
18       Iris-setosa        0      Iris-setosa
19       Iris-setosa        0      Iris-setosa
20       Iris-setosa        0      Iris-setosa
21       Iris-setosa        0      Iris-setosa
22       Iris-setosa        0      Iris-setosa
23       Iris-setosa        0      Iris-setosa
24       Iris-setosa        0      Iris-setosa
25       Iris-setosa        0      Iris-setosa
26       Iris-setosa        0      Iris-setosa
27       Iris-setosa        0      Iris-setosa
28       Iris-setosa        0      Iris-setosa
29       Iris-setosa        0      Iris-setosa
30       Iris-setosa        0      Iris-setosa
31       Iris-setosa        0      Iris-setosa
32       Iris-setosa        0      Iris-setosa
33       Iris-setosa        0      Iris-setosa
34       Iris-setosa        0      Iris-setosa
35       Iris-setosa        0      Iris-setosa
36       Iris-setosa        0      Iris-setosa
37       Iris-setosa        0      Iris-setosa
38       Iris-setosa        0      Iris-setosa
39       Iris-setosa        0      Iris-setosa
40       Iris-setosa        0      Iris-setosa
41       Iris-setosa        0      Iris-setosa
42       Iris-setosa        0      Iris-setosa
43       Iris-setosa        0      Iris-setosa
44       Iris-setosa        0      Iris-setosa
45       Iris-setosa        0      Iris-setosa
46       Iris-setosa        0      Iris-setosa
47       Iris-setosa        0      Iris-setosa
48       Iris-setosa        0      Iris-setosa
49       Iris-setosa        0      Iris-setosa
50   Iris-versicolor        1   Iris-virginica
51   Iris-versicolor        2  Iris-versicolor
52   Iris-versicolor        1   Iris-virginica
53   Iris-versicolor        2  Iris-versicolor
54   Iris-versicolor        2  Iris-versicolor
55   Iris-versicolor        2  Iris-versicolor
56   Iris-versicolor        2  Iris-versicolor
57   Iris-versicolor        2  Iris-versicolor
58   Iris-versicolor        2  Iris-versicolor
59   Iris-versicolor        2  Iris-versicolor
60   Iris-versicolor        2  Iris-versicolor
61   Iris-versicolor        2  Iris-versicolor
62   Iris-versicolor        2  Iris-versicolor
63   Iris-versicolor        2  Iris-versicolor
64   Iris-versicolor        2  Iris-versicolor
65   Iris-versicolor        2  Iris-versicolor
66   Iris-versicolor        2  Iris-versicolor
67   Iris-versicolor        2  Iris-versicolor
68   Iris-versicolor        2  Iris-versicolor
69   Iris-versicolor        2  Iris-versicolor
70   Iris-versicolor        2  Iris-versicolor
71   Iris-versicolor        2  Iris-versicolor
72   Iris-versicolor        2  Iris-versicolor
73   Iris-versicolor        2  Iris-versicolor
74   Iris-versicolor        2  Iris-versicolor
75   Iris-versicolor        2  Iris-versicolor
76   Iris-versicolor        2  Iris-versicolor
77   Iris-versicolor        1   Iris-virginica
78   Iris-versicolor        2  Iris-versicolor
79   Iris-versicolor        2  Iris-versicolor
80   Iris-versicolor        2  Iris-versicolor
81   Iris-versicolor        2  Iris-versicolor
82   Iris-versicolor        2  Iris-versicolor
83   Iris-versicolor        2  Iris-versicolor
84   Iris-versicolor        2  Iris-versicolor
85   Iris-versicolor        2  Iris-versicolor
86   Iris-versicolor        1   Iris-virginica
87   Iris-versicolor        2  Iris-versicolor
88   Iris-versicolor        2  Iris-versicolor
89   Iris-versicolor        2  Iris-versicolor
90   Iris-versicolor        2  Iris-versicolor
91   Iris-versicolor        2  Iris-versicolor
92   Iris-versicolor        2  Iris-versicolor
93   Iris-versicolor        2  Iris-versicolor
94   Iris-versicolor        2  Iris-versicolor
95   Iris-versicolor        2  Iris-versicolor
96   Iris-versicolor        2  Iris-versicolor
97   Iris-versicolor        2  Iris-versicolor
98   Iris-versicolor        2  Iris-versicolor
99   Iris-versicolor        2  Iris-versicolor
100   Iris-virginica        1   Iris-virginica
101   Iris-virginica        2  Iris-versicolor
102   Iris-virginica        1   Iris-virginica
103   Iris-virginica        1   Iris-virginica
104   Iris-virginica        1   Iris-virginica
105   Iris-virginica        1   Iris-virginica
106   Iris-virginica        2  Iris-versicolor
107   Iris-virginica        1   Iris-virginica
108   Iris-virginica        1   Iris-virginica
109   Iris-virginica        1   Iris-virginica
110   Iris-virginica        1   Iris-virginica
111   Iris-virginica        1   Iris-virginica
112   Iris-virginica        1   Iris-virginica
113   Iris-virginica        2  Iris-versicolor
114   Iris-virginica        1   Iris-virginica
115   Iris-virginica        1   Iris-virginica
116   Iris-virginica        1   Iris-virginica
117   Iris-virginica        1   Iris-virginica
118   Iris-virginica        1   Iris-virginica
119   Iris-virginica        2  Iris-versicolor
120   Iris-virginica        1   Iris-virginica
121   Iris-virginica        2  Iris-versicolor
122   Iris-virginica        1   Iris-virginica
123   Iris-virginica        2  Iris-versicolor
124   Iris-virginica        1   Iris-virginica
125   Iris-virginica        1   Iris-virginica
126   Iris-virginica        2  Iris-versicolor
127   Iris-virginica        1   Iris-virginica
128   Iris-virginica        1   Iris-virginica
129   Iris-virginica        1   Iris-virginica
130   Iris-virginica        1   Iris-virginica
131   Iris-virginica        1   Iris-virginica
132   Iris-virginica        1   Iris-virginica
133   Iris-virginica        2  Iris-versicolor
134   Iris-virginica        2  Iris-versicolor
135   Iris-virginica        1   Iris-virginica
136   Iris-virginica        1   Iris-virginica
137   Iris-virginica        1   Iris-virginica
138   Iris-virginica        2  Iris-versicolor
139   Iris-virginica        1   Iris-virginica
140   Iris-virginica        1   Iris-virginica
141   Iris-virginica        1   Iris-virginica
142   Iris-virginica        2  Iris-versicolor
143   Iris-virginica        1   Iris-virginica
144   Iris-virginica        1   Iris-virginica
145   Iris-virginica        1   Iris-virginica
146   Iris-virginica        1   Iris-virginica
147   Iris-virginica        1   Iris-virginica
148   Iris-virginica        1   Iris-virginica
149   Iris-virginica        2  Iris-versicolor
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="uts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">UTS</p>
      </div>
    </a>
    <a class="right-next"
       href="decisiontree.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Decision Tree</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">K-Means Clustering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah-algoritma-k-means">Langkah-langkah algoritma K-Means :</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi-hasil-k-means">Evaluasi Hasil K-Means</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#komputasi-k-means-data-iris">Komputasi K-Means Data IRIS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klaster">2 Klaster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3 Klaster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4 Klaster</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metode-elbow">Metode Elbow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzy-c-mean">Fuzzy C-mean</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#konsep-fuzzy-c-mean">Konsep Fuzzy C-mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah">Langkah-langkah</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#komputasi-fuzzy-c-mean">Komputasi Fuzzy C-mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-data-iris-3-klaster">Implementasi data iris 3 klaster</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nabiilah Rizqi Amalia
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>